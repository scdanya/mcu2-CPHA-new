[gcode_macro First]
gcode:
  Move_pad_s1 MOVE=-46
  Move_pad_s2 move=-265
  RESPOND PREFIX=tgalarm MSG="Первая точка"

[gcode_macro Second]
gcode:
  Move_pad_s1 MOVE=-63
  Move_pad_s2 move=-265
  RESPOND PREFIX=tgalarm MSG="Вторая точка"

[gcode_macro Third]
gcode:
  Move_pad_s1 MOVE=-81
  Move_pad_s2 move=-265
  RESPOND PREFIX=tgalarm MSG="Третья точка"

[gcode_macro Fourth]
gcode:
  Move_pad_s1 MOVE=-99
  Move_pad_s2 move=-265
  RESPOND PREFIX=tgalarm MSG="Четвертая точка"

[gcode_macro Fifth]
gcode:
  Move_pad_s1 MOVE=-117
  Move_pad_s2 move=-265
  RESPOND PREFIX=tgalarm MSG="Пятая точка"

[gcode_macro Sixth]
gcode:
  Move_pad_s1 MOVE=-135
  Move_pad_s2 move=-265
  RESPOND PREFIX=tgalarm MSG="Шестая точка"

[gcode_macro Seventh]
gcode:
  Move_pad_s1 MOVE=-154
  Move_pad_s2 move=-265
  RESPOND PREFIX=tgalarm MSG="Седьмая точка"

[gcode_macro Eighth]
gcode:
  Move_pad_s1 MOVE=-172
  Move_pad_s2 move=-265
  RESPOND PREFIX=tgalarm MSG="Восьмая точка"

[gcode_macro Nineth]
gcode:
  Move_pad_s1 MOVE=-190
  Move_pad_s2 move=-265
  RESPOND PREFIX=tgalarm MSG="Девятая точка"

[gcode_macro Tenth]
gcode:
  Move_pad_s1 MOVE=-208
  Move_pad_s2 move=-265
  RESPOND PREFIX=tgalarm MSG="Десятая точка"

[gcode_macro Take_out]
gcode:
  Move_pad_s1 move=-265
  Move_pad_s2 move=-265

[gcode_macro Home]
gcode:
    MANUAL_STEPPER STEPPER=s1 ENABLE=1 SPEED=25 SET_POSITION=-320 MOVE=0 STOP_ON_ENDSTOP=1
    RESPOND PREFIX=tgalarm MSG="Каретка_1 в начальной позиции"
    MANUAL_STEPPER STEPPER=s2 ENABLE=1 SPEED=25 SET_POSITION=-320 MOVE=0 STOP_ON_ENDSTOP=1
    RESPOND PREFIX=tgalarm MSG="Каретка_2 в начальной позиции"

[gcode_macro Home_s1]
gcode:
    MANUAL_STEPPER STEPPER=s1 ENABLE=1 SPEED=25 SET_POSITION=-320 MOVE=0 STOP_ON_ENDSTOP=1
    RESPOND PREFIX=tgalarm MSG="Каретка в начальной позиции"

[gcode_macro Home_s2]
gcode:
    MANUAL_STEPPER STEPPER=s2 ENABLE=1 SPEED=25 SET_POSITION=-320 MOVE=0 STOP_ON_ENDSTOP=1
    RESPOND PREFIX=tgalarm MSG="Каретка в начальной позиции"

[gcode_macro Move_pad_s1]
gcode: 
    {% set dist = params.MOVE|default(5) %}
      MANUAL_STEPPER STEPPER=s1 SPEED=15 MOVE={dist} 
      M400
      Disable_pump_pad

[gcode_macro Move_pad_s2]
gcode: 
    {% set dist = params.MOVE|default(5) %}
      MANUAL_STEPPER STEPPER=s2 SPEED=15 MOVE={dist} 
      M400
      Disable_pump_pad
    
[gcode_macro Enable_pump_pad]
gcode:
    {% set state = params.ENABLE|default(1) %}
    {% set pumps = ['s1', 's2'] %}
    {% for pump in pumps %}
        MANUAL_STEPPER STEPPER={pump} ENABLE={state}
    {% endfor %}

[gcode_macro Disable_pump_pad]
gcode: 
    {% set state = params.ENABLE|default(0) %}
    {% set pumps = ['s1', 's2'] %}
    {% for pump in pumps %}
        MANUAL_STEPPER STEPPER={pump} ENABLE={state}
    {% endfor %}

[gcode_macro sampling_1]
gcode:
    M400
    {% set speed = params.SPEED|default(0.5) %}
    {% set syn = params.SYNC|default(0) %}
    {% set purge_distance = params.MOVE|default(2) %}
    {% set pump = params.STEPPER|default('s1') %}
    MANUAL_STEPPER STEPPER={pump} MOVE={purge_distance} SPEED={speed} SYNC={syn} SET_POSITION=0 
    RESPOND PREFIX=tgalarm MSG="Выполнен отбор помпой {pump} на {purge_distance} шагов со скоростью {speed} мм/сек"
    MANUAL_STEPPER STEPPER={pump} ENABLE=0 